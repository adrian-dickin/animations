{"version":3,"sources":["../es6/reel2.js"],"names":["ReelDancer","colour","speeds","who","_speeds","_colour","_twoBars","_who","radius","cx","cy","sectionIndex","_sectionIndex","section","_sections","_angle","angle","_maxCount","_step","stepSign","Math","PI","_count","_centreIndex","centreIndex","x","cos","y","sin","_position","place","ctx","beginPath","fillStyle","strokeStyle","arc","fill","stroke","font","fillText","RshReelDancer","Reel","counts","whoToPlot","_path","_dancers","_counts","_timeCount","_whoToPlot","_endCallback","red","green","blue","_makeDancer","countIndexes","that","map","countIndex","push","forEach","dancer","calcPosition","updatePosition","position","canvas","document","getElementById","getContext","clearRect","width","height","_drawPath","draw","path","xy","calcAndMove","_draw","_endTimeCount","window","requestAnimationFrame","_doFrame","timeCount","places","i","length","endTimeCount","console","log","endCallback"],"mappings":"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","file":"reel2.js","sourcesContent":["\nclass ReelDancer {\n\tconstructor(colour, speeds, who) {\n\t\tthis._speeds = speeds;\n\t\tthis._colour = colour;\n\t\tthis._twoBars = 0;\n\t\tthis._who = who;\n\t\tthis.radius = 100.0;\n\t\tthis.cx = 140;\n\t\tthis.cy = 130;\n\t}\n\t\n\t/* Move onto a specific section. */\n\tplace(sectionIndex) {\n\t\tthis._sectionIndex = sectionIndex;\n\t\tlet section = this._sections[sectionIndex];\n\t\tthis._angle = section.angle;\n\t\tthis._maxCount = this._speeds[this._twoBars];\n\t\tthis._step = section.stepSign * Math.PI / this._maxCount;\n\t\tthis._count = 0;\n\t\tthis._centreIndex = section.centreIndex;\n\t}\n\t\n\tcalcPosition() {\n\t\tlet x = this.cx + 2.0 * this.radius * this._centreIndex + this.radius * Math.cos(this._angle);\n\t\tlet y = this.cy + this.radius * Math.sin(this._angle);\n\t\tthis._position = {x, y};\n\t}\n\t\n\tget position() {\n\t\treturn this._position;\n\t}\n\t\n\tupdatePosition() {\n\t\tthis._count += 1;\n\t\tthis._angle += this._step;\n\t\tif (this._count === this._maxCount) {\n\t\t\tthis._twoBars += 1;\n\t\t\tif (this._sectionIndex === 3) {\n\t\t\t\tthis.place(0);\n\t\t\t} else {\n\t\t\t\tthis.place(this._sectionIndex + 1);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tdraw(ctx) {\n\t\tctx.beginPath();\n\t\tctx.fillStyle = this._colour;\n\t\tctx.strokeStyle = this._colour;\n\t\tctx.arc(this._position.x, this._position.y, 20, 0.0, 2.0 * Math.PI);\n\t\tctx.fill();\n\t\tctx.stroke();\n\t\tctx.font = '30px serif';\n\t\tctx.fillStyle = \"white\";\t\n\t\tctx.fillText((this._who + 1), this._position.x - 8, this._position.y + 10); \n\t}\n};\n\nclass RshReelDancer extends ReelDancer {\n\tconstructor(sectionIndex, colour, speeds, who) {\n\t\tsuper(colour, speeds, who);\n\t\tthis._sections = [\n\t\t\t{angle: Math.PI, stepSign: 1, centreIndex: 0},\n\t\t\t{angle: Math.PI, stepSign: -1, centreIndex: 1},\n\t\t\t{angle: 0.0, stepSign: -1, centreIndex: 1},\n\t\t\t{angle: 0.0, stepSign: 1, centreIndex: 0}\n\t\t];\n\t\tthis.place(sectionIndex);\n\t}\n};\n\nclass Reel {\n\tconstructor(counts, whoToPlot) {\n\t\tthis._path=  [];\n\t\tthis._dancers = [];\n\t\tthis._counts = counts;\n\t\tthis._timeCount = 0;\n\t\tthis._whoToPlot = whoToPlot;\n\t\tthis._endCallback = null;\n\t\t\n\t\tconst red = \"#e00000\";\n\t\tconst green = \"#00e000\";\n\t\tconst blue = \"#0000e0\";\n\t\t\n\t\tthis._makeDancer(0, red, [1, 1, 1, 1], 0);\n\t\tthis._makeDancer(3, green, [1, 1, 1, 1], 1);\n\t\tthis._makeDancer(2, blue, [0, 2, 0, 2], 2);\n\t}\n\t\n\t_makeDancer(section, colour, countIndexes, who) {\n\t\tvar that = this;\n\t\tlet counts = countIndexes.map(countIndex => that._counts[countIndex]);\n\t\tthis._dancers.push(new RshReelDancer(section, colour, counts, who));\n\t}\n\t\n\tcalcAndMove() {\n\t\tthis._dancers.forEach(function(dancer) {\n\t\t\tdancer.calcPosition();\n\t\t\tdancer.updatePosition();\n\t\t});\n\t\tthis._path.push(this._dancers[this._whoToPlot].position);\n\t}\n\t\n\t_draw() {\n\t\tlet canvas = document.getElementById('canvas');\n\t\tlet ctx = canvas.getContext('2d');\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t\tthis._drawPath(ctx, this._path);\n\t\tthis._dancers.forEach(dancer => dancer.draw(ctx));\n\t}\n\t\n\t_drawPath(ctx, path) {\n\t\tctx.fillStyle = '#a0a0a0';\n\t\tctx.strokeStyle = '#a0a0a0';\n\t\tpath.forEach(xy => {\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(xy.x, xy.y, 3, 0.0, 2.0 * Math.PI);\n\t\t\tctx.fill();\n\t\t\tctx.stroke();\n\t\t});\t\n\t}\n\t\n\t_doFrame() {\n\t    var that = this;\n\t\tthis.calcAndMove();\n\t\tthis._draw();\t\n\t\tthis._timeCount += 1;\n\t\tif (this._timeCount <= this._endTimeCount) {\n            window.requestAnimationFrame(function() {that._doFrame(); });\n\t\t} else {\n\t\t\tthis._endCallback();\n\t\t}\n\t}\n\t\n\tstartFrom(timeCount, places) {\n\t\tfor(var i = 0; i< places.length; i++) {\n\t\t\tthis._dancers[i].place(places[i]);\n\t\t}\n\t\tthis._timeCount = timeCount;\n\t}\n\trender() {\n\t\tthis._dancers.forEach(function(dancer) {\n\t\t\tdancer.calcPosition();\n\t\t});\n\t\tthis._draw();\n\t}\n\tanimate(endTimeCount) {\n\t\tvar that = this;\n\t\tthis._endTimeCount = endTimeCount;\n\t\tconsole.log('pre');\n        window.requestAnimationFrame( function() { that._doFrame(); } );\n\t\tconsole.log('post');\n\t}\n\t\n\tset endCallback(endCallback) {\n\t\tthis._endCallback = endCallback;\n\t}\n};\n\n\n"]}