{"version":3,"sources":["../es6/reel2.js"],"names":["ReelDancer","colour","speeds","who","_speeds","_colour","_twoBars","_who","radius","cx","cy","sectionIndex","console","log","_sectionIndex","section","_sections","_angle","angle","_maxCount","_step","stepSign","Math","PI","_count","_centreIndex","centreIndex","x","cos","y","sin","_position","place","ctx","beginPath","fillStyle","strokeStyle","arc","fill","stroke","font","fillText","RshReelDancer","Reel","counts","whoToPlot","_path","_dancers","_counts","_timeCount","_whoToPlot","_endCallback","red","green","blue","_makeDancer","countIndexes","that","map","countIndex","push","forEach","dancer","calcPosition","updatePosition","position","canvas","document","getElementById","getContext","clearRect","width","height","_drawPath","draw","path","xy","calcAndMove","_draw","_endTimeCount","window","requestAnimationFrame","_doFrame","timeCount","places","i","length","endTimeCount","endCallback"],"mappings":"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","file":"reel2.js","sourcesContent":["\nclass ReelDancer {\n\tconstructor(colour, speeds, who) {\n\t\tthis._speeds = speeds;\n\t\tthis._colour = colour;\n\t\tthis._twoBars = 0;\n\t\tthis._who = who;\n\t\tthis.radius = 100.0;\n\t\tthis.cx = 140;\n\t\tthis.cy = 130;\n\t}\n\t\n\t/* Move onto a specific section. */\n\tplace(sectionIndex) {\n\tconsole.log('PLACE');\n\t\tthis._sectionIndex = sectionIndex;\n\t\tlet section = this._sections[sectionIndex];\n\t\tthis._angle = section.angle;\n\t\tthis._maxCount = this._speeds[this._twoBars];\n\t\tthis._step = section.stepSign * Math.PI / this._maxCount;\n\t\tthis._count = 0;\n\t\tthis._centreIndex = section.centreIndex;\n\t}\n\t\n\tcalcPosition() {\n\t\tlet x = this.cx + 2.0 * this.radius * this._centreIndex + this.radius * Math.cos(this._angle);\n\t\tlet y = this.cy + this.radius * Math.sin(this._angle);\n\t\tconsole.log(x);\n\t\tconsole.log(this.cx + ' ' + this.radius + ' ' + this._centreIndex);\n\t\tthis._position = {x, y};\n\t}\n\t\n\tget position() {\n\t\treturn this._position;\n\t}\n\t\n\tupdatePosition() {\n\t\tthis._count += 1;\n\t\tthis._angle += this._step;\n\t\tif (this._count === this._maxCount) {\n\t\t\tthis._twoBars += 1;\n\t\t\tif (this._sectionIndex === 3) {\n\t\t\t\tthis.place(0);\n\t\t\t} else {\n\t\t\t\tthis.place(this._sectionIndex + 1);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tdraw(ctx) {\n\t\tctx.beginPath();\n\t\tctx.fillStyle = this._colour;\n\t\tctx.strokeStyle = this._colour;\n\t\tctx.arc(this._position.x, this._position.y, 20, 0.0, 2.0 * Math.PI);\n\t\tctx.fill();\n\t\tctx.stroke();\n\t\tconsole.log(this);\n\t\tctx.font = '30px serif';\n\t\tctx.fillStyle = \"white\";\t\n\t\tctx.fillText((this._who + 1), this._position.x - 8, this._position.y + 10); \n\t}\n};\n\nclass RshReelDancer extends ReelDancer {\n\tconstructor(sectionIndex, colour, speeds, who) {\n\t\tsuper(colour, speeds, who);\n\t\tthis._sections = [\n\t\t\t{angle: Math.PI, stepSign: 1, centreIndex: 0},\n\t\t\t{angle: Math.PI, stepSign: -1, centreIndex: 1},\n\t\t\t{angle: 0.0, stepSign: -1, centreIndex: 1},\n\t\t\t{angle: 0.0, stepSign: 1, centreIndex: 0}\n\t\t];\n\t\tthis.place(sectionIndex);\n\t}\n};\n\nclass Reel {\n\tconstructor(counts, whoToPlot) {\n\t\tthis._path=  [];\n\t\tthis._dancers = [];\n\t\tthis._counts = counts;\n\t\tthis._timeCount = 0;\n\t\tthis._whoToPlot = whoToPlot;\n\t\tthis._endCallback = null;\n\t\t\n\t\tconst red = \"#e00000\";\n\t\tconst green = \"#00e000\";\n\t\tconst blue = \"#0000e0\";\n\t\t\n\t\tthis._makeDancer(0, red, [1, 1, 1, 1], 0);\n\t\tthis._makeDancer(3, green, [1, 1, 1, 1], 1);\n\t\tthis._makeDancer(2, blue, [0, 2, 0, 2], 2);\n\t}\n\t\n\t_makeDancer(section, colour, countIndexes, who) {\n\t\tvar that = this;\n\t\tlet counts = countIndexes.map(countIndex => that._counts[countIndex]);\n\t\tthis._dancers.push(new RshReelDancer(section, colour, counts, who));\n\t}\n\t\n\tcalcAndMove() {\n\t\tthis._dancers.forEach(function(dancer) {\n\t\t\tdancer.calcPosition();\n\t\t\tdancer.updatePosition();\n\t\t});\n\t\tthis._path.push(this._dancers[this._whoToPlot].position);\n\t}\n\t\n\t_draw() {\n\t\tlet canvas = document.getElementById('canvas');\n\t\tlet ctx = canvas.getContext('2d');\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t\tthis._drawPath(ctx, this._path);\n\t\tthis._dancers.forEach(dancer => dancer.draw(ctx));\n\t}\n\t\n\t_drawPath(ctx, path) {\n\t\tctx.fillStyle = '#a0a0a0';\n\t\tctx.strokeStyle = '#a0a0a0';\n\t\tpath.forEach(xy => {\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(xy.x, xy.y, 3, 0.0, 2.0 * Math.PI);\n\t\t\tctx.fill();\n\t\t\tctx.stroke();\n\t\t});\t\n\t}\n\t\n\t_doFrame() {\n\t    var that = this;\n\t\tconsole.log(this);\n\t\tthis.calcAndMove();\n\t\tthis._draw();\t\n\t\tthis._timeCount += 1;\n\t\tif (this._timeCount <= this._endTimeCount) {\n            window.requestAnimationFrame(function() {that._doFrame(); });\n\t\t} else {\n\t\t\tthis._endCallback();\n\t\t}\n\t}\n\t\n\tstartFrom(timeCount, places) {\n\t\tfor(var i = 0; i< places.length; i++) {\n\t\t\tthis._dancers[i].place(places[i]);\n\t\t}\n\t\tthis._timeCount = timeCount;\n\t}\n\trender() {\n\t\tthis._dancers.forEach(function(dancer) {\n\t\t\tdancer.calcPosition();\n\t\t});\n\t\tthis._draw();\n\t}\n\tanimate(endTimeCount) {\n\t\tvar that = this;\n\t\tthis._endTimeCount = endTimeCount;\n\t\tconsole.log('pre');\n        window.requestAnimationFrame( function() { that._doFrame(); } );\n\t\tconsole.log('post');\n\t}\n\t\n\tset endCallback(endCallback) {\n\t\tthis._endCallback = endCallback;\n\t}\n};\n\n/*\nvar reel = {\n\t_path: [],\n\t_dancers: [],\n\t_counts: [],\n\t_timeCount: 0,\n\t_whoToPlot: 0,\n\t_endCallback: null,\n\t\n\tinit: function(counts, whoToPlot) {\n\t\tthis._path = [];\n\t\tthis._dancers = [];\n\t\tthis._counts = counts;\n\t\tthis._timeCount = 0;\n\t\tthis._whoToPlot = whoToPlot;\n\t\t\n\t\tvar colours = [\n\t\t\t\"#e00000\",\n\t\t\t\"#00e000\",\n\t\t\t\"#0000e0\"];\n\t\t\n\t\tthis._makeDancer(0, colours[0], [1, 1, 1, 1], 0);\n\t\tthis._makeDancer(3, colours[1], [1, 1, 1, 1], 1);\n\t\tthis._makeDancer(2, colours[2], [0, 2, 0, 2], 2);\n\t},\n\t\n\tsetEndCallback: function(endCallback) {\n\t\tthis._endCallback = endCallback;\n\t},\n\t\n\tgetFullReelCount: function() {\n\t\treturn this._counts[1];\n\t},\n\t\n\t_makeDancer: function(section, colour, countIndexes, who) {\n\t\tvar counts = [];\n\t\tcountIndexes.forEach(function(countIndex) {\n\t\t\tcounts.push(reel._counts[countIndex]);\n\t\t});\n\t\tthis._dancers.push(new Dancer(section, colour, counts, who));\n\t},\n\t\n\tcalcAndMove: function() {\n\t\tthis._dancers.forEach(function(dancer) {\n\t\t\tdancer.calcPosition();\n\t\t\tdancer.updatePosition();\n\t\t});\n\t\tthis._path.push(this._dancers[this._whoToPlot].getPosition());\n\t},\n\t\n\t_draw: function() {\n\t\tvar canvas = document.getElementById('canvas');\n\t\tvar ctx = canvas.getContext('2d');\n\t\tctx.clearRect(0, 0, canvas.width, canvas.height);\n\t\tthis._drawPath(ctx, this._path);\n\t\tthis._dancers.forEach(function(dancer) {\n\t\t\tdancer.draw(ctx);\n\t\t});\n\n\t},\n\t\n\t_drawPath: function(ctx, path) {\n\t\tctx.fillStyle = '#a0a0a0';\n\t\tctx.strokeStyle = '#a0a0a0';\n\t\tpath.forEach(function(xy) {\n\t\t\tctx.beginPath();\n\t\t\tctx.arc(xy.x, xy.y, 3, 0.0, 2.0 * Math.PI);\n\t\t\tctx.fill();\n\t\t\tctx.stroke();\n\t\t});\t\n\t},\n\t\n\t_doFrame: function() {\n\t\tthis.calcAndMove();\n\t\tthis._draw();\t\n\t\tthis._timeCount += 1;\n\t\tif (this._timeCount <= this._endTimeCount) {\n\t\t\twindow.requestAnimationFrame(function() {\n\t\t\t\treel._doFrame();\n\t\t\t});\n\t\t} else {\n\t\t\tthis._endCallback();\n\t\t}\n\t},\n\t\n\tstartFrom: function(timeCount, places) {\n\t\tfor(var i = 0; i< places.length; i++) {\n\t\t\tthis._dancers[i].place(places[i]);\n\t\t}\n\t\tthis._timeCount = timeCount;\n\t},\n\trender: function() {\n\t\tthis._dancers.forEach(function(dancer) {\n\t\t\tdancer.calcPosition();\n\t\t});\n\t\tthis._draw();\n\t},\n\tanimate: function(endTimeCount) {\n\t\tthis._endTimeCount = endTimeCount;\n\t\twindow.requestAnimationFrame(function() {\n\t\t\treel._doFrame();\n\t\t});\n\t}\n};*/\n\n"]}